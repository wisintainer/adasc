<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:adm="http://github.com/adminfaces"
	template="#{layoutMB.template}">

	<ui:define name="title">
        Novo Orçamento
    </ui:define>

	<ui:define name="body">

		<h:form prependId="false">
			<div class="box box-primary">
				<p:wizard flowListener="#{orcamentoMB.onFlowProcess}" id="wizard"
					widgetVar="wiz" nextLabel="Próximo" backLabel="Voltar">
					<p:tab id="veiculo" title="1 - Informações do Veículo">
						<div class="box-header with-border">
							<div class="ui-g ui-fluid"></div>

							<div class="ui-g ui-fluid">
								<div class="ui-g-2 ui-sm-1">
									<div class="ui-material">
										<p:inputText id="fabricante"
											placeholder="Fabricante do Veículo"
											value="#{orcamentoMB.orcamento.veiculoFabricante}" />
										<p:outputLabel for="fabricante" value="Fabricante" />
										<p:message for="fabricante" />
									</div>
								</div>

								<div class="ui-g-2 ui-sm-1">
									<div class="ui-material">
										<p:inputText id="modelo"
											value="#{orcamentoMB.orcamento.veiculoModelo}"
											placeholder="Modelo do Veículo" />
										<p:outputLabel for="modelo" value="Modelo" />
										<p:message for="modelo" />
									</div>
								</div>

								<div class="ui-g-1 ui-sm-1">
									<div class="ui-material">
										<p:inputText id="anoFabricacao"
											value="#{orcamentoMB.orcamento.veiculoAnoFabricao}"
											placeholder="Ano de Fabricação" />
										<p:outputLabel for="anoFabricacao" value="Ano de Fabricação" />
										<p:message for="anoFabricacao" />
									</div>
								</div>

								<div class="ui-g-1 ui-sm-1">
									<div class="ui-material">
										<p:inputText id="anoModelo"
											value="#{orcamentoMB.orcamento.veiculoAnoModelo}"
											placeholder="Ano Modelo" />
										<p:outputLabel for="anoModelo" value="Ano Modelo" />
										<p:message for="anoModelo" />
									</div>
								</div>

								<div class="ui-g-2 ui-sm-1">
									<div class="ui-material">
										<p:inputMask mask="aaa-9*99" id="placa"
											value="#{orcamentoMB.orcamento.veiculoPlaca}"
											placeholder="Placa do Veículo" />
										<p:outputLabel for="placa" value="Placa" />
										<p:message for="placa" />
									</div>
								</div>

								<div class="ui-g-2 ui-sm-1">
									<div class="ui-material">
										<p:inputText id="chassi"
											value="#{orcamentoMB.orcamento.veiculoChassi}"
											placeholder="Chassi do Veículo" />
										<p:outputLabel for="chassi" value="Chassi" />
										<p:message for="chassi" />
									</div>
									<p:spacer />
								</div>

							</div>
						</div>
					</p:tab>
					<p:tab id="produtos" title="2 - Produtos/Serviços">
						<h:form>
							<div class="box box-primary">
								<div class="box-header with-border">
									<div class="ui-g ui-fluid">
										<div class="ui-g-4 ui-sm-2">
											<div class="ui-material">
												<p:inputText id="produto" required="true"
													value="#{orcamentoMB.produtoServico}"
													placeholder="Produto/Serviço" />
												<p:outputLabel for="produto" value="Produto/Serviço" />
												<p:message for="produto" />
											</div>
										</div>

										<div class="ui-g-2 ui-sm-1">
											<div class="ui-material">
												<p:inputText id="quantidade" required="true"
													value="#{orcamentoMB.quantidade}" placeholder="Quantidade" />
												<p:outputLabel for="quantidade" value="Quantidade" />
												<p:message for="quantidade" />
											</div>
										</div>

										<div class="ui-g-1 ui-sm-2">
											<div class="ui-material">
												<p:commandButton action="#{orcamentoMB.adicionarItem}"
													update="panelItensOrcamento" process="@parent"
													value="Adicionar" styleClass="btn-primary"
													icon="fa fa-plus" />
											</div>
										</div>
									</div>

									<p:panel id="panelItensOrcamento">
										<p:dataTable id="itensTable" rowIndexVar="rowIndex"
											value="#{orcamentoMB.itensOrcamento}"
											widgetVar="itensOrcamentoTable" rows="20" var="item"
											paginator="true" paginatorPosition="bottom"
											paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
											currentPageReportTemplate=""
											rowsPerPageTemplate="5,10,15,20,30">

											<p:column style="text-align: center;" headerText="Item">
												<p:outputLabel value="#{rowIndex+1}" />
											</p:column>

											<p:column style="text-align: center;"
												headerText="Produto/Serviço">
												<p:outputLabel value="#{item.produtoServico}" />
											</p:column>

											<p:column style="text-align: center;" headerText="Quantidade">
												<p:outputLabel value="#{item.quantidade}" />
											</p:column>

											<p:column style="text-align: center;" headerText="Excluir">
												<p:commandButton process="@this" update="itensTable"
													styleClass="btn-danger" value="Excluir"
													action="#{orcamentoMB.removerItem}" icon="fa fa-close">
													<f:setPropertyActionListener value="#{item}"
														target="#{orcamentoMB.itemOrcamentoExcluir}" />
												</p:commandButton>
											</p:column>
										</p:dataTable>
									</p:panel>
								</div>
							</div>
						</h:form>
					</p:tab>
					<p:tab id="fornecedores" title="3 - Fornecedores">

						<h:form id="form-forn" prependId="false">
							<div class="box box-primary">
								<div class="box-header with-border">
									<div class="ui-g ui-fluid">
										<div class="ui-g-2 ui-sm-1">
											<div class="ui-material">
												<p:commandButton process="@form" value="Buscar Fornecedores"
													oncomplete="{PF('buscaDeFornecedores').show();}"
													styleClass="btn-primary" icon="fa fa-search" />
											</div>
										</div>
									</div>

									<div class="ui-g ui-fluid">
										<div class="ui-g-12 ui-sm-6">
											<p:dataTable value="#{orcamentoMB.fornecedoresSelecionados}"
												id="table-forn" rows="5" paginator="true"
												paginatorPosition="bottom"
												paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
												currentPageReportTemplate=""
												rowsPerPageTemplate="5,10,15,20,30" selectionMode="single"
												selection="#{orcamentoMB.fornecedorSelecionadoParaAdicionar}"
												var="fornecedorBuscado" rowKey="#{fornecedorBuscado.id}">
												<p:column headerText="CNPJ">
													<p:outputLabel value="#{fornecedorBuscado.cnpj}" />
												</p:column>
												<p:column headerText="Fornecedor">
													<p:outputLabel value="#{fornecedorBuscado.nome}" />
												</p:column>
											</p:dataTable>
										</div>
									</div>
								</div>
							</div>
						</h:form>
					</p:tab>

					<p:tab id="entrega" title="4 - Entrega">

						<div class="box box-primary">
							<div class="box-header with-border">
								<div class="ui-g ui-fluid">
									<div class="ui-g-3 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="empresa" 
												value="#{orcamentoMB.orcamento.entrega_empresa}"
												placeholder="Empresa" />
											<p:outputLabel for="empresa" value="Empresa" />
											<p:message for="empresa" />
										</div>
									</div>

									<div class="ui-g-3 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="responsavel" 
												value="#{orcamentoMB.orcamento.entrega_responsavel}"
												placeholder="Responsável" />
											<p:outputLabel for="responsavel" value="Responsável" />
											<p:message for="responsavel" />
										</div>
									</div>

									<div class="ui-g-2 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="telefone" 
												value="#{orcamentoMB.orcamento.entrega_telefone}"
												placeholder="Telefone" />
											<p:outputLabel for="telefone" value="Telefone" />
											<p:message for="telefone" />
										</div>
									</div>

									<div class="ui-g-3 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="email" 
												value="#{orcamentoMB.orcamento.entrega_email}"
												placeholder="E-mail" />
											<p:outputLabel for="email" value="E-mail" />
											<p:message for="email" />
										</div>
									</div>
								</div>
								<div class="ui-g ui-fluid">
									<div class="ui-g-3 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="endereco" 
												value="#{orcamentoMB.orcamento.entrega_endereco}"
												placeholder="Endereço" />
											<p:outputLabel for="endereco" value="Endereço" />
											<p:message for="endereco" />
										</div>
									</div>

									<div class="ui-g-1 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="numero" 
												value="#{orcamentoMB.orcamento.entrega_numero}"
												placeholder="Número" />
											<p:outputLabel for="numero" value="Número" />
											<p:message for="numero" />
										</div>
									</div>

									<div class="ui-g-2 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="bairro" 
												value="#{orcamentoMB.orcamento.entrega_bairro}"
												placeholder="Bairro" />
											<p:outputLabel for="bairro" value="Bairro" />
											<p:message for="bairro" />
										</div>
									</div>

									<div class="ui-g-2 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="cidade" 
												value="#{orcamentoMB.orcamento.entrega_cidade}"
												placeholder="Cidade" />
											<p:outputLabel for="cidade" value="Cidade" />
											<p:message for="cidade" />
										</div>
									</div>

									<div class="ui-g-1 ui-sm-1">
										<div class="ui-material">
											<p:selectOneMenu
												value="#{orcamentoMB.orcamento.entrega_estado}">
												<f:selectItem itemLabel="SC" itemValue="SC" />

												<f:selectItem itemLabel="AC" itemValue="AC" />
												<f:selectItem itemLabel="AL" itemValue="AL" />
												<f:selectItem itemLabel="AP" itemValue="AP" />
												<f:selectItem itemLabel="AM" itemValue="AM" />
												<f:selectItem itemLabel="BA" itemValue="BA" />
												<f:selectItem itemLabel="CE" itemValue="CE" />
												<f:selectItem itemLabel="DF" itemValue="DF" />
												<f:selectItem itemLabel="ES" itemValue="ES" />
												<f:selectItem itemLabel="GO" itemValue="GO" />
												<f:selectItem itemLabel="MA" itemValue="MA" />
												<f:selectItem itemLabel="MT" itemValue="MT" />
												<f:selectItem itemLabel="MS" itemValue="MS" />
												<f:selectItem itemLabel="MG" itemValue="MG" />
												<f:selectItem itemLabel="PA" itemValue="PA" />
												<f:selectItem itemLabel="PB" itemValue="PB" />
												<f:selectItem itemLabel="PR" itemValue="PR" />
												<f:selectItem itemLabel="PE" itemValue="PE" />
												<f:selectItem itemLabel="PI" itemValue="PI" />
												<f:selectItem itemLabel="RJ" itemValue="RJ" />
												<f:selectItem itemLabel="RN" itemValue="RN" />
												<f:selectItem itemLabel="RS" itemValue="RS" />
												<f:selectItem itemLabel="RO" itemValue="RO" />
												<f:selectItem itemLabel="RR" itemValue="RR" />
												<f:selectItem itemLabel="SP" itemValue="SP" />
												<f:selectItem itemLabel="SE" itemValue="SE" />
												<f:selectItem itemLabel="TO" itemValue="TO" />
											</p:selectOneMenu>
										</div>
									</div>

									<div class="ui-g-2 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="cep" 
												value="#{orcamentoMB.orcamento.entrega_cep}"
												placeholder="CEP" />
											<p:outputLabel for="cep" value="CEP" />
											<p:message for="cep" />
										</div>
									</div>
								</div>
							</div>
						</div>

					</p:tab>

					<p:tab id="requisitante" title="5 - Requisitante">
						<div class="box box-primary">
							<div class="box-header with-border">
								<div class="ui-g ui-fluid">
									<div class="ui-g-3 ui-sm-1">
										<div class="ui-material">
											<p:inputText id="req" required="true"
												value="#{orcamentoMB.orcamento.entrega_requisitante}"
												placeholder="Nome do Requisitante" />
											<p:outputLabel for="req" value="Requisitante" />
											<p:message for="req" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</p:tab>

					<p:tab id="finalizar" title="6 - Finalizar">
						<div class="box box-primary">
							<div class="box-header with-border">
								<div class="ui-g ui-fluid">
									<div class="ui-g-2">
										<p:commandButton process="@form"
											action="#{orcamentoMB.salvarSolicitacaoDeOrcamento}"
											icon="fa fa-paper-plane-o" styleClass="btn btn-success"
											value="Solicitar Orçamentos" />
									</div>

								</div>
							</div>
						</div>
					</p:tab>
				</p:wizard>

			</div>
		</h:form>
		<p:spacer />







		<p:dialog header="Busca de Fornecedores" resizable="false" width="80%"
			appendTo="@(body)" height="50%" modal="true" closable="false"
			widgetVar="buscaDeFornecedores" responsive="true"
			styleClass="box-success">
			<p:panel id="panelBuscaFornecedores">
				<h:form prependId="false">
					<div class="box box-primary">
						<div class="box-header with-border">
							<div class="ui-g ui-fluid">
								<div class="ui-g-4 ui-sm-2">
									<div class="ui-material">
										<p:inputText id="nomeFornecedorBusca" required="true"
											value="#{orcamentoMB.nomeFornecedorParaBuscar}"
											placeholder="Nome" />
										<p:outputLabel for="nomeFornecedorBusca" value="Nome" />
										<p:message for="nomeFornecedorBusca" />
									</div>
								</div>

							</div>

							<div class="ui-g ui-fluid">
								<div class="ui-g-2 ui-sm-1">
									<p:commandButton value="Buscar" update="panelBuscaFornecedores"
										action="#{orcamentoMB.buscarFornecedoresPorNome}"
										styleClass="btn-primary" icon="fa fa-check" />
								</div>
							</div>

							<div class="ui-g ui-fluid">
								<div class="ui-g-5 ui-sm-2">
									<p:dataTable value="#{orcamentoMB.fornecedoresBuscados}"
										rows="5" paginator="true" paginatorPosition="bottom"
										paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
										currentPageReportTemplate=""
										rowsPerPageTemplate="5,10,15,20,30" selectionMode="single"
										selection="#{orcamentoMB.fornecedorSelecionadoParaAdicionar}"
										var="fornecedorBuscado" rowKey="#{fornecedorBuscado.id}">
										<p:column headerText="CNPJ">
											<p:outputLabel value="#{fornecedorBuscado.cnpj}" />
										</p:column>
										<p:column headerText="Fornecedor">
											<p:outputLabel value="#{fornecedorBuscado.nome}" />
										</p:column>
									</p:dataTable>
								</div>

								<div class="ui-g-1 ui-sm-1">
									<p:commandButton process="@form" icon="fa fa-arrow-right"
										update="panelBuscaFornecedores"
										action="#{orcamentoMB.adicionarFornecedor}" />
								</div>

								<div class="ui-g-5 ui-sm-2">
									<p:dataTable value="#{orcamentoMB.fornecedoresSelecionados}"
										rows="5" paginator="true" paginatorPosition="bottom"
										paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
										currentPageReportTemplate=""
										rowsPerPageTemplate="5,10,15,20,30"
										var="fornecedorSelecionado">
										<p:column headerText="CNPJ">
											<p:outputLabel value="#{fornecedorSelecionado.cnpj}" />
										</p:column>
										<p:column headerText="Fornecedor">
											<p:outputLabel value="#{fornecedorSelecionado.nome}" />
										</p:column>

										<p:column headerText="Ação">
											<p:commandButton style="width: 50%;"
												styleClass="btn btn-danger" value="Excluir"
												icon="fa fa-close" />
										</p:column>
									</p:dataTable>
								</div>
							</div>
						</div>
					</div>
					<div class="ui-g-12" style="align-content: center;">
						<div class="ui-g-2 ui-sm-1">
							<p:commandButton value="Concluir" update="table-forn"
								process="@form" oncomplete="{PF('buscaDeFornecedores').hide();}"
								styleClass="btn-success" icon="fa fa-check" />
						</div>
					</div>
				</h:form>
			</p:panel>
		</p:dialog>
	</ui:define>

</ui:composition>